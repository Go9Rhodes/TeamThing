<!doctype html>
<!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if IE 7]>    <html class="no-js lt-ie9 lt-ie8" lang="en"> <![endif]-->
<!--[if IE 8]>    <html class="no-js lt-ie9" lang="en"> <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js" lang="en">
<!--<![endif]-->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title></title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width">
    <link href="http://cdn.kendostatic.com/2012.1.322/styles/kendo.common.min.css" rel="stylesheet" />
    <link href="http://cdn.kendostatic.com/2012.1.322/styles/kendo.default.min.css" rel="stylesheet" />
    <link href="http://cdn.kendostatic.com/2012.1.322/styles/kendo.dataviz.min.css" rel="stylesheet" />
    <link href="/Content/Site.css" rel="stylesheet" />
    
    <script src="/Scripts/modernizr-2.5.3.min.js"></script>
    <script src="/Scripts/path.min.js"></script>
    <script src="http://code.jquery.com/jquery-1.7.1.min.js"></script>
    <script src="http://cdn.kendostatic.com/2012.1.322/js/kendo.all.min.js"></script>
    <script src="/Scripts/teamThing.js"></script>

    <style>
        .formFieldList li
        {
            list-style: none outside none;
            list-style: none;
            padding-bottom: 8px;
            margin: 0;
        }
        .formFieldList ol
        {
            margin: 15px;
            padding: 0;
        }
        
        .publicTeam
        {
            color: Green;
        }
        
        .closedTeam
        {
            color: red;
        }
        .teamListItem, .thingListItem, .userListItem
        {
            margin: 3px 0px;
        }
        
        .hidden 
        {
            display:none;
        }
        
        .searchResult 
        {
             margin: 0px;
             margin-top:3px;
        }
        
        .searchResult.error
        {
            color:Red;
        }
        
        .searchResult.ok
        {
            color:Green;
        }
    </style>
</head>
<body>
    <!--[if lt IE 7]><p class=chromeframe>Your browser is <em>ancient!</em> <a href="http://browsehappy.com/">Upgrade to a different browser</a> or <a href="http://www.google.com/chromeframe/?redirect=true">install Google Chrome Frame</a> to experience this site.</p><![endif]-->
    <div id="teamThing" class="bkgnd-smooth-dark">
        <h1>
            TeamThing</h1>
        <div id="navigation" class="navigation">
            <a href="/my" class="nav k-button k-view-button">Home</a> <a href="/logout" class="nav k-button k-view-button">
                Logout</a>
        </div>
        <div id="appFrame">
        </div>
    </div>
    <div id="dialog" class="window"></div>
    <script type="text/x-kendo-tmpl" id="teamListTemplate">
        <div class="teamListItem">
            <a href="/team/#= team.Id #" class="nav k-button k-view-button"><span class="k-icon k-search"></span></a>

            #if( userCanEditTeam() ) { #
                <button class="k-button k-edit-button" data-bind="click:editTeam"><span class="k-icon k-edit"></span></button>
                <button class="k-button k-delete-button" data-bind="click:removeTeam"><span class="k-icon k-delete"></span></button>
            # } #
            <span class="# if(team.IsPublic) { #
                            publicTeam
                      # } else { #
                            closedTeam
                       # } #">#= team.Name # </span>
            <input type="hidden" class="teamId" id="teamId" value="#= team.Id #"/>
            
        </div>
    </script>
    <script type="text/x-kendo-tmpl" id="thingListTemplate">
        <div class="thingListItem">
                <input type="hidden" class="thingId" id="thingId" value="#= Id #"/>
                <button class="k-button k-view-button" title="View Thing"><span class="k-icon k-search"></span></button>
                <button class="k-button k-edit-button" title="Edit Thing"><span class="k-icon k-edit"></span></button>
                <button class="k-button k-delete-button" title="Delete Thing"><span class="k-icon k-delete"></span></button>
                #= Description # 
        </div>
    </script>
    <script type="text/x-kendo-tmpl" id="teamUserListTemplate">
        <div class="userListItem">
                <button class="k-button k-view-button" title="View User" data-bind="click:viewUser">View</button>
                <button class="k-button k-edit-button" title="Edit User" data-bind="click:editUser"><span class="k-icon k-edit"></span></button>
                <button class="k-button k-delete-button" title="Deny User" data-bind="click:denyUser"><span class="k-icon k-cancel"></span></button>
                #= user.EmailAddress # 
        </div>
    </script>
    <script type="text/x-kendo-tmpl" id="teamPendingUserListTemplate">
        <div class="pendingUserListItem">
                <button class="k-button k-view-button" title="Approve User" data-bind="click:approveUser"><span class="k-icon k-update"></span></button>
                <button class="k-button k-delete-button" title="Deny User" data-bind="click:denyUser"><span class="k-icon k-cancel"></span></button>
                #= user.EmailAddress # 
        </div>
    </script>
    <script type="text/x-kendo-tmpl" id="userSignInTemplate">
        <div id="userLogin">
            <ol class="formFieldList">
                <li>
                    <input id="userName" type="text" data-bind="value:userName" />
                </li>
                <li class="commands">
                    <button class="k-button" data-bind="click:registerUser">Register</button>
                    <button class="k-button" data-bind="click:signInUser">Sign In</button>
                </li>
            </ol>
        </div>
    </script>
    <script type="text/x-kendo-tmpl" id="teamDashboardTemplate">
       <div id="teamDashboard">
            <h2 data-bind="text:team.Name">
            </h2>
             <div class="k-toolbar k-grid-toolbar">
                <button class="k-button k-button-icontext k-add-button" data-bind="click:addThing">
                    <span class="k-icon k-add"></span>Add a Thing
                </button>
            </div>
            <h3>Team Members</h3>

            <div data-role="tabstrip">
                <ul>
                  <li class="k-state-active">Approved</li>
                  #if(pendingTeamMembers.length > 0 ) { #
                      <li>Pending</li>
                  # } #
                </ul>
                    <div id="teamUserList" data-template="teamUserListTemplate" data-role="listview" data-bind="source:teamMembers">
                    </div>

                #if(pendingTeamMembers.length > 0 ) { #
                    <div id="teamPendingUserList" data-template="teamPendingUserListTemplate" data-role="listview" data-bind="source:pendingTeamMembers">
                    </div>
                # } #
            </div>
        </div>
    </script>
    <script type="text/x-kendo-tmpl" id="userDashboardTemplate">
        <div id="userDashboard">
            <h2 data-bind="text:UserName">
            </h2>
            <div class="k-toolbar k-grid-toolbar">
                <button class="k-button k-button-icontext k-add-button" data-bind="click:createTeam">
                    <span class="k-icon k-add"></span>Create new team
                </button> 
                <button class="k-button k-button-icontext k-add-button" data-bind="click:joinTeam">
                    <span class="k-icon k-add"></span>Join a team
                </button>
            </div>
            <div data-role="tabstrip">
                <ul>
                    <li class="k-state-active">My Things</li>
                    <li>My Teams</li>
                    #if(pendingTeams.length > 0 ) { #
                        <li>Pending Teams</li>
                    # } #
                </ul>
                <!---using class becuase the id is killed when it is put into a tab strip! --->
                <div id="userThings" data-template="thingListTemplate" data-role="listview" data-bind="source:things">
                </div>
                <div id="teamListView" class="teamListView" data-template="teamListTemplate" data-role="listview" data-bind="source:teams">
                </div>
                #if(pendingTeams.length > 0 ) { #
                    <div id="pendingTeamListView" class="pendingTeamListView" data-template="teamListTemplate" data-role="listview" data-bind="source:pendingTeams">
                    </div>
                # } #
            </div>
        </div>
    </script>

</body>
<script>

    $(function () {
        application.init($("#teamThing"));
    });

</script>
</html>
